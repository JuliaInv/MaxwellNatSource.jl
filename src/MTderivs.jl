export MTderivs


function MTderivs( D1::Array{Complex128,1}, D2::Array{Complex128,1} )

    # Differentiate dZ/dD for one receiver location.
    # In the derivative matrix, the 8 rows are ordered:
    #    [ Z11r Z11i  Z21r Z21i  Z12r Z12i  Z22r Z22i ]
    # and the 2*8 columns are ordered:
    #    [ Ex1r Ex1i  Ey1r Ey1i  Hx1r Hx1i  Hy1r Hy1i ]
    #    [ Ex2r Ex2i  Ey2r Ey2i  Hx2r Hx2i  Hy2r Hy2i ]

    #function DD = MTderivs(Ex1i,Ex2i,Ex1r,Ex2r,Ey1i,Ey2i,Ey1r,Ey2r,Hx1i,Hx2i,Hx1r,Hx2r,Hy1i,Hy2i,Hy1r,Hy2r)
    #MTDERIVS

    #    This function was generated by the Symbolic Math Toolbox version 7.1.
    #    24-Jan-2017 15:28:27

    if length(D1) != 4 || length(D2) != 4
        error("data length != 4")
    end

    Ex1r, Ex1i = reim(D1[1])
    Ey1r, Ey1i = reim(D1[2])
    Hx1r, Hx1i = reim(D1[3])
    Hy1r, Hy1i = reim(D1[4])

    Ex2r, Ex2i = reim(D2[1])
    Ey2r, Ey2i = reim(D2[2])
    Hx2r, Hx2i = reim(D2[3])
    Hy2r, Hy2i = reim(D2[4])

    t2 = Hy2i^2
    t3 = Hx1i^2
    t4 = Hy2r^2
    t5 = Hx2i^2
    t6 = Hy1i^2
    t7 = Hx1r^2
    t8 = Hx2r^2
    t9 = Hy1r^2
    t10 = t2*t3
    t11 = t5*t6
    t12 = t3*t4
    t13 = t5*t9
    t14 = t2*t7
    t15 = t6*t8
    t16 = t4*t7
    t17 = t8*t9
    t18 = Hx1i*Hx2r*Hy2i*Hy1r*2.0
    t19 = Hx2i*Hx1r*Hy1i*Hy2r*2.0
    t22 = Hx1i*Hx2i*Hy1i*Hy2i*2.0
    t23 = Hx1i*Hx2i*Hy1r*Hy2r*2.0
    t24 = Hx1i*Hx2r*Hy1i*Hy2r*2.0
    t25 = Hx2i*Hx1r*Hy2i*Hy1r*2.0
    t26 = Hx1r*Hx2r*Hy1i*Hy2i*2.0
    t27 = Hx1r*Hx2r*Hy1r*Hy2r*2.0
    t20 = t10+t11+t12+t13+t14+t15+t16+t17+t18+t19-t22-t23-t24-t25-t26-t27
    t21 = 1.0./t20
    t28 = 1.0./t20^2
    t29 = Ex1i*Hx1i*t2
    t30 = Ex2i*Hx2i*t6
    t31 = Ex1i*Hx1i*t4
    t32 = Ex2i*Hx2i*t9
    t33 = Ex1r*Hx1r*t2
    t34 = Ex2r*Hx2r*t6
    t35 = Ex1r*Hx1r*t4
    t36 = Ex2r*Hx2r*t9
    t37 = Ex1i*Hx2r*Hy2i*Hy1r
    t38 = Ex2i*Hx1r*Hy1i*Hy2r
    t39 = Ex1r*Hx2i*Hy1i*Hy2r
    t40 = Ex2r*Hx1i*Hy2i*Hy1r
    t42 = Ex1i*Hx2i*Hy1i*Hy2i
    t43 = Ex2i*Hx1i*Hy1i*Hy2i
    t44 = Ex1i*Hx2i*Hy1r*Hy2r
    t45 = Ex1i*Hx2r*Hy1i*Hy2r
    t46 = Ex2i*Hx1i*Hy1r*Hy2r
    t47 = Ex2i*Hx1r*Hy2i*Hy1r
    t48 = Ex1r*Hx2i*Hy2i*Hy1r
    t49 = Ex1r*Hx2r*Hy1i*Hy2i
    t50 = Ex2r*Hx1i*Hy1i*Hy2r
    t51 = Ex2r*Hx1r*Hy1i*Hy2i
    t52 = Ex1r*Hx2r*Hy1r*Hy2r
    t53 = Ex2r*Hx1r*Hy1r*Hy2r
    t41 = t29+t30+t31+t32+t33+t34+t35+t36+t37+t38+t39+t40-t42-t43-t44-t45-t46-t47-t48-t49-t50-t51-t52-t53
    t54 = Hx1i*t2
    t55 = Hx1i*t4
    t56 = Hx2r*Hy2i*Hy1r
    t178 = Hx2i*Hy1i*Hy2i
    t179 = Hx2i*Hy1r*Hy2r
    t180 = Hx2r*Hy1i*Hy2r
    t57 = t54+t55+t56-t178-t179-t180
    t58 = t21*t57
    t59 = Hx1r*t2
    t60 = Hx1r*t4
    t61 = Hx2i*Hy1i*Hy2r
    t175 = Hx2i*Hy2i*Hy1r
    t176 = Hx2r*Hy1i*Hy2i
    t177 = Hx2r*Hy1r*Hy2r
    t62 = t59+t60+t61-t175-t176-t177
    t63 = t21*t62
    t64 = Ex1i*t2
    t65 = Ex1i*t4
    t66 = Ex2r*Hy2i*Hy1r
    t67 = t64+t65+t66-Ex2i*Hy1i*Hy2i-Ex2i*Hy1r*Hy2r-Ex2r*Hy1i*Hy2r
    t68 = t21*t67
    t69 = Hx1r*t2*2.0
    t70 = Hx1r*t4*2.0
    t71 = Hx2i*Hy1i*Hy2r*2.0
    t181 = Hx2i*Hy2i*Hy1r*2.0
    t182 = Hx2r*Hy1i*Hy2i*2.0
    t183 = Hx2r*Hy1r*Hy2r*2.0
    t72 = t69+t70+t71-t181-t182-t183
    t73 = Ex1r*t2
    t74 = Ex1r*t4
    t75 = Ex2i*Hy1i*Hy2r
    t76 = t73+t74+t75-Ex2i*Hy2i*Hy1r-Ex2r*Hy1i*Hy2i-Ex2r*Hy1r*Hy2r
    t77 = t21*t76
    t78 = Hx1i*t2*2.0
    t79 = Hx1i*t4*2.0
    t80 = Hx2r*Hy2i*Hy1r*2.0
    t184 = Hx2i*Hy1i*Hy2i*2.0
    t185 = Hx2i*Hy1r*Hy2r*2.0
    t186 = Hx2r*Hy1i*Hy2r*2.0
    t81 = t78+t79+t80-t184-t185-t186
    t82 = Ex1i*Hx1r*t2
    t83 = Ex2i*Hx2r*t6
    t84 = Ex1i*Hx1r*t4
    t85 = Ex2i*Hx2r*t9
    t86 = Ex1i*Hx2i*Hy1i*Hy2r
    t87 = Ex2i*Hx1i*Hy2i*Hy1r
    t88 = Ex1r*Hx2i*Hy1i*Hy2i
    t89 = Ex2r*Hx1i*Hy1i*Hy2i
    t90 = Ex1r*Hx2i*Hy1r*Hy2r
    t91 = Ex1r*Hx2r*Hy1i*Hy2r
    t92 = Ex2r*Hx1i*Hy1r*Hy2r
    t93 = Ex2r*Hx1r*Hy2i*Hy1r
    t105 = Ex1r*Hx1i*t2
    t106 = Ex2r*Hx2i*t6
    t107 = Ex1r*Hx1i*t4
    t108 = Ex2r*Hx2i*t9
    t109 = Ex1i*Hx2i*Hy2i*Hy1r
    t110 = Ex1i*Hx2r*Hy1i*Hy2i
    t111 = Ex2i*Hx1i*Hy1i*Hy2r
    t112 = Ex2i*Hx1r*Hy1i*Hy2i
    t113 = Ex1i*Hx2r*Hy1r*Hy2r
    t114 = Ex2i*Hx1r*Hy1r*Hy2r
    t115 = Ex1r*Hx2r*Hy2i*Hy1r
    t116 = Ex2r*Hx1r*Hy1i*Hy2r
    t94 = t82+t83+t84+t85+t86+t87+t88+t89+t90+t91+t92+t93-t105-t106-t107-t108-t109-t110-t111-t112-t113-t114-t115-t116
    t95 = Ex1i*Hx2i*Hy2i
    t96 = Ex2i*Hx1i*Hy2i
    t97 = Ex1i*Hx2r*Hy2r
    t98 = Ex1r*Hx2r*Hy2i
    t99 = Ex2r*Hx1i*Hy2r
    t100 = Ex2r*Hx1r*Hy2i
    t101 = Hy1r*t5*2.0
    t102 = Hy1r*t8*2.0
    t103 = Hx1i*Hx2r*Hy2i*2.0
    t200 = Hx1i*Hx2i*Hy2r*2.0
    t201 = Hx2i*Hx1r*Hy2i*2.0
    t202 = Hx1r*Hx2r*Hy2r*2.0
    t104 = t101+t102+t103-t200-t201-t202
    t117 = Ex1i*Hx2i*Hy2r
    t118 = Ex2i*Hx1i*Hy2r
    t119 = Ex2i*Hx1r*Hy2i
    t120 = Ex1r*Hx2i*Hy2i
    t121 = Ex1r*Hx2r*Hy2r
    t122 = Ex2r*Hx1r*Hy2r
    t123 = Hy1i*t5*2.0
    t124 = Hy1i*t8*2.0
    t125 = Hx2i*Hx1r*Hy2r*2.0
    t215 = Hx1i*Hx2i*Hy2i*2.0
    t216 = Hx1i*Hx2r*Hy2r*2.0
    t217 = Hx1r*Hx2r*Hy2i*2.0
    t126 = t123+t124+t125-t215-t216-t217
    t127 = Hx2i*t6
    t128 = Hx2i*t9
    t129 = Hx1r*Hy1i*Hy2r
    t221 = Hx1i*Hy1i*Hy2i
    t222 = Hx1i*Hy1r*Hy2r
    t223 = Hx1r*Hy2i*Hy1r
    t130 = t127+t128+t129-t221-t222-t223
    t131 = t21*t130
    t132 = Hx2r*t6
    t133 = Hx2r*t9
    t134 = Hx1i*Hy2i*Hy1r
    t218 = Hx1i*Hy1i*Hy2r
    t219 = Hx1r*Hy1i*Hy2i
    t220 = Hx1r*Hy1r*Hy2r
    t135 = t132+t133+t134-t218-t219-t220
    t136 = t21*t135
    t137 = Ex2i*t6
    t138 = Ex2i*t9
    t139 = Ex1r*Hy1i*Hy2r
    t140 = t137+t138+t139-Ex1i*Hy1i*Hy2i-Ex1i*Hy1r*Hy2r-Ex1r*Hy2i*Hy1r
    t141 = t21*t140
    t142 = Hx2r*t6*2.0
    t143 = Hx2r*t9*2.0
    t144 = Hx1i*Hy2i*Hy1r*2.0
    t224 = Hx1i*Hy1i*Hy2r*2.0
    t225 = Hx1r*Hy1i*Hy2i*2.0
    t226 = Hx1r*Hy1r*Hy2r*2.0
    t145 = t142+t143+t144-t224-t225-t226
    t146 = Ex2r*t6
    t147 = Ex2r*t9
    t148 = Ex1i*Hy2i*Hy1r
    t149 = t146+t147+t148-Ex1i*Hy1i*Hy2r-Ex1r*Hy1i*Hy2i-Ex1r*Hy1r*Hy2r
    t150 = t21*t149
    t151 = Hx2i*t6*2.0
    t152 = Hx2i*t9*2.0
    t153 = Hx1r*Hy1i*Hy2r*2.0
    t227 = Hx1i*Hy1i*Hy2i*2.0
    t228 = Hx1i*Hy1r*Hy2r*2.0
    t229 = Hx1r*Hy2i*Hy1r*2.0
    t154 = t151+t152+t153-t227-t228-t229
    t155 = Ex1i*Hx2i*Hy1i
    t156 = Ex2i*Hx1i*Hy1i
    t157 = Ex2i*Hx1r*Hy1r
    t158 = Ex1r*Hx2i*Hy1r
    t159 = Ex1r*Hx2r*Hy1i
    t160 = Ex2r*Hx1r*Hy1i
    t161 = Hy2r*t3*2.0
    t162 = Hy2r*t7*2.0
    t163 = Hx2i*Hx1r*Hy1i*2.0
    t230 = Hx1i*Hx2i*Hy1r*2.0
    t231 = Hx1i*Hx2r*Hy1i*2.0
    t232 = Hx1r*Hx2r*Hy1r*2.0
    t164 = t161+t162+t163-t230-t231-t232
    t165 = Ex1i*Hx2i*Hy1r
    t166 = Ex1i*Hx2r*Hy1i
    t167 = Ex2i*Hx1i*Hy1r
    t168 = Ex2r*Hx1i*Hy1i
    t169 = Ex1r*Hx2r*Hy1r
    t170 = Ex2r*Hx1r*Hy1r
    t171 = Hy2i*t3*2.0
    t172 = Hy2i*t7*2.0
    t173 = Hx1i*Hx2r*Hy1r*2.0
    t233 = Hx1i*Hx2i*Hy1i*2.0
    t234 = Hx2i*Hx1r*Hy1r*2.0
    t235 = Hx1r*Hx2r*Hy1i*2.0
    t174 = t171+t172+t173-t233-t234-t235
    t187 = Ey1i*Hx1i*t2
    t188 = Ey2i*Hx2i*t6
    t189 = Ey1i*Hx1i*t4
    t190 = Ey2i*Hx2i*t9
    t191 = Ey1r*Hx1r*t2
    t192 = Ey2r*Hx2r*t6
    t193 = Ey1r*Hx1r*t4
    t194 = Ey2r*Hx2r*t9
    t195 = Ey1i*Hx2r*Hy2i*Hy1r
    t196 = Ey2i*Hx1r*Hy1i*Hy2r
    t197 = Ey1r*Hx2i*Hy1i*Hy2r
    t198 = Ey2r*Hx1i*Hy2i*Hy1r
    t203 = Ey1i*Hx2i*Hy1i*Hy2i
    t204 = Ey2i*Hx1i*Hy1i*Hy2i
    t205 = Ey1i*Hx2i*Hy1r*Hy2r
    t206 = Ey1i*Hx2r*Hy1i*Hy2r
    t207 = Ey2i*Hx1i*Hy1r*Hy2r
    t208 = Ey2i*Hx1r*Hy2i*Hy1r
    t209 = Ey1r*Hx2i*Hy2i*Hy1r
    t210 = Ey1r*Hx2r*Hy1i*Hy2i
    t211 = Ey2r*Hx1i*Hy1i*Hy2r
    t212 = Ey2r*Hx1r*Hy1i*Hy2i
    t213 = Ey1r*Hx2r*Hy1r*Hy2r
    t214 = Ey2r*Hx1r*Hy1r*Hy2r
    t199 = t187+t188+t189+t190+t191+t192+t193+t194+t195+t196+t197+t198-t203-t204-t205-t206-t207-t208-t209-t210-t211-t212-t213-t214
    t236 = Ey1i*t2
    t237 = Ey1i*t4
    t238 = Ey2r*Hy2i*Hy1r
    t239 = t236+t237+t238-Ey2i*Hy1i*Hy2i-Ey2i*Hy1r*Hy2r-Ey2r*Hy1i*Hy2r
    t240 = t21*t239
    t241 = Ey1r*t2
    t242 = Ey1r*t4
    t243 = Ey2i*Hy1i*Hy2r
    t244 = t241+t242+t243-Ey2i*Hy2i*Hy1r-Ey2r*Hy1i*Hy2i-Ey2r*Hy1r*Hy2r
    t245 = t21*t244
    t246 = Ey1i*Hx1r*t2
    t247 = Ey2i*Hx2r*t6
    t248 = Ey1i*Hx1r*t4
    t249 = Ey2i*Hx2r*t9
    t250 = Ey1i*Hx2i*Hy1i*Hy2r
    t251 = Ey2i*Hx1i*Hy2i*Hy1r
    t252 = Ey1r*Hx2i*Hy1i*Hy2i
    t253 = Ey2r*Hx1i*Hy1i*Hy2i
    t254 = Ey1r*Hx2i*Hy1r*Hy2r
    t255 = Ey1r*Hx2r*Hy1i*Hy2r
    t256 = Ey2r*Hx1i*Hy1r*Hy2r
    t257 = Ey2r*Hx1r*Hy2i*Hy1r
    t265 = Ey1r*Hx1i*t2
    t266 = Ey2r*Hx2i*t6
    t267 = Ey1r*Hx1i*t4
    t268 = Ey2r*Hx2i*t9
    t269 = Ey1i*Hx2i*Hy2i*Hy1r
    t270 = Ey1i*Hx2r*Hy1i*Hy2i
    t271 = Ey2i*Hx1i*Hy1i*Hy2r
    t272 = Ey2i*Hx1r*Hy1i*Hy2i
    t273 = Ey1i*Hx2r*Hy1r*Hy2r
    t274 = Ey2i*Hx1r*Hy1r*Hy2r
    t275 = Ey1r*Hx2r*Hy2i*Hy1r
    t276 = Ey2r*Hx1r*Hy1i*Hy2r
    t258 = t246+t247+t248+t249+t250+t251+t252+t253+t254+t255+t256+t257-t265-t266-t267-t268-t269-t270-t271-t272-t273-t274-t275-t276
    t259 = Ey1i*Hx2i*Hy2i
    t260 = Ey2i*Hx1i*Hy2i
    t261 = Ey1i*Hx2r*Hy2r
    t262 = Ey1r*Hx2r*Hy2i
    t263 = Ey2r*Hx1i*Hy2r
    t264 = Ey2r*Hx1r*Hy2i
    t277 = Ey1i*Hx2i*Hy2r
    t278 = Ey2i*Hx1i*Hy2r
    t279 = Ey2i*Hx1r*Hy2i
    t280 = Ey1r*Hx2i*Hy2i
    t281 = Ey1r*Hx2r*Hy2r
    t282 = Ey2r*Hx1r*Hy2r
    t283 = Ey2i*t6
    t284 = Ey2i*t9
    t285 = Ey1r*Hy1i*Hy2r
    t286 = t283+t284+t285-Ey1i*Hy1i*Hy2i-Ey1i*Hy1r*Hy2r-Ey1r*Hy2i*Hy1r
    t287 = t21*t286
    t288 = Ey2r*t6
    t289 = Ey2r*t9
    t290 = Ey1i*Hy2i*Hy1r
    t291 = t288+t289+t290-Ey1i*Hy1i*Hy2r-Ey1r*Hy1i*Hy2i-Ey1r*Hy1r*Hy2r
    t292 = t21*t291
    t293 = Ey1i*Hx2i*Hy1i
    t294 = Ey2i*Hx1i*Hy1i
    t295 = Ey2i*Hx1r*Hy1r
    t296 = Ey1r*Hx2i*Hy1r
    t297 = Ey1r*Hx2r*Hy1i
    t298 = Ey2r*Hx1r*Hy1i
    t299 = Ey1i*Hx2i*Hy1r
    t300 = Ey1i*Hx2r*Hy1i
    t301 = Ey2i*Hx1i*Hy1r
    t302 = Ey2r*Hx1i*Hy1i
    t303 = Ey1r*Hx2r*Hy1r
    t304 = Ey2r*Hx1r*Hy1r
    t305 = Ex1i*Hy1i*t5
    t306 = Ex2i*Hy2i*t3
    t307 = Ex1i*Hy1i*t8
    t308 = Ex2i*Hy2i*t7
    t309 = Ex1r*Hy1r*t5
    t310 = Ex2r*Hy2r*t3
    t311 = Ex1r*Hy1r*t8
    t312 = Ex2r*Hy2r*t7
    t313 = Ex1i*Hx2i*Hx1r*Hy2r
    t314 = Ex2i*Hx1i*Hx2r*Hy1r
    t315 = Ex1r*Hx1i*Hx2r*Hy2i
    t316 = Ex2r*Hx2i*Hx1r*Hy1i
    t318 = Ex1i*Hx1i*Hx2i*Hy2i
    t319 = Ex2i*Hx1i*Hx2i*Hy1i
    t320 = Ex1i*Hx1i*Hx2r*Hy2r
    t321 = Ex1i*Hx1r*Hx2r*Hy2i
    t322 = Ex2i*Hx2i*Hx1r*Hy1r
    t323 = Ex2i*Hx1r*Hx2r*Hy1i
    t324 = Ex1r*Hx1i*Hx2i*Hy2r
    t325 = Ex1r*Hx2i*Hx1r*Hy2i
    t326 = Ex2r*Hx1i*Hx2i*Hy1r
    t327 = Ex2r*Hx1i*Hx2r*Hy1i
    t328 = Ex1r*Hx1r*Hx2r*Hy2r
    t329 = Ex2r*Hx1r*Hx2r*Hy1r
    t317 = t305+t306+t307+t308+t309+t310+t311+t312+t313+t314+t315+t316-t318-t319-t320-t321-t322-t323-t324-t325-t326-t327-t328-t329
    t330 = Ex2i*Hx1r*Hy1i
    t331 = Ex2r*Hx1i*Hy1r
    t332 = Hy1i*t5
    t333 = Hy1i*t8
    t334 = Hx2i*Hx1r*Hy2r
    t414 = Hx1i*Hx2i*Hy2i
    t415 = Hx1i*Hx2r*Hy2r
    t416 = Hx1r*Hx2r*Hy2i
    t335 = t332+t333+t334-t414-t415-t416
    t336 = t21*t335
    t337 = Hy1r*t5
    t338 = Hy1r*t8
    t339 = Hx1i*Hx2r*Hy2i
    t411 = Hx1i*Hx2i*Hy2r
    t412 = Hx2i*Hx1r*Hy2i
    t413 = Hx1r*Hx2r*Hy2r
    t340 = t337+t338+t339-t411-t412-t413
    t341 = t21*t340
    t342 = Ex2i*Hx2i*Hy1i
    t343 = Ex1r*Hx2i*Hy2r
    t344 = Ex2r*Hx2i*Hy1r
    t345 = Ex2r*Hx2r*Hy1i
    t346 = Ex1i*Hx2r*Hy2i
    t347 = Ex2i*Hx2i*Hy1r
    t348 = Ex2i*Hx2r*Hy1i
    t349 = Ex2r*Hx2r*Hy1r
    t350 = Ex1i*Hy1r*t5
    t351 = Ex2i*Hy2r*t3
    t352 = Ex1i*Hy1r*t8
    t353 = Ex2i*Hy2r*t7
    t354 = Ex1i*Hx1i*Hx2r*Hy2i
    t355 = Ex2i*Hx2i*Hx1r*Hy1i
    t356 = Ex1r*Hx1i*Hx2i*Hy2i
    t357 = Ex2r*Hx1i*Hx2i*Hy1i
    t358 = Ex1r*Hx1i*Hx2r*Hy2r
    t359 = Ex1r*Hx1r*Hx2r*Hy2i
    t360 = Ex2r*Hx2i*Hx1r*Hy1r
    t361 = Ex2r*Hx1r*Hx2r*Hy1i
    t368 = Ex1r*Hy1i*t5
    t369 = Ex2r*Hy2i*t3
    t370 = Ex1r*Hy1i*t8
    t371 = Ex2r*Hy2i*t7
    t372 = Ex1i*Hx1i*Hx2i*Hy2r
    t373 = Ex1i*Hx2i*Hx1r*Hy2i
    t374 = Ex2i*Hx1i*Hx2i*Hy1r
    t375 = Ex2i*Hx1i*Hx2r*Hy1i
    t376 = Ex1i*Hx1r*Hx2r*Hy2r
    t377 = Ex2i*Hx1r*Hx2r*Hy1r
    t378 = Ex1r*Hx2i*Hx1r*Hy2r
    t379 = Ex2r*Hx1i*Hx2r*Hy1r
    t362 = t350+t351+t352+t353+t354+t355+t356+t357+t358+t359+t360+t361-t368-t369-t370-t371-t372-t373-t374-t375-t376-t377-t378-t379
    t363 = Ex1i*t5
    t364 = Ex1i*t8
    t365 = Ex2r*Hx2i*Hx1r
    t366 = t363+t364+t365-Ex2i*Hx1i*Hx2i-Ex2i*Hx1r*Hx2r-Ex2r*Hx1i*Hx2r
    t367 = t21*t366
    t380 = Ex1r*t5
    t381 = Ex1r*t8
    t382 = Ex2i*Hx1i*Hx2r
    t383 = t380+t381+t382-Ex2i*Hx2i*Hx1r-Ex2r*Hx1i*Hx2i-Ex2r*Hx1r*Hx2r
    t384 = t21*t383
    t385 = Hy2i*t3
    t386 = Hy2i*t7
    t387 = Hx1i*Hx2r*Hy1r
    t445 = Hx1i*Hx2i*Hy1i
    t446 = Hx2i*Hx1r*Hy1r
    t447 = Hx1r*Hx2r*Hy1i
    t388 = t385+t386+t387-t445-t446-t447
    t389 = t21*t388
    t390 = Hy2r*t3
    t391 = Hy2r*t7
    t392 = Hx2i*Hx1r*Hy1i
    t442 = Hx1i*Hx2i*Hy1r
    t443 = Hx1i*Hx2r*Hy1i
    t444 = Hx1r*Hx2r*Hy1r
    t393 = t390+t391+t392-t442-t443-t444
    t394 = t21*t393
    t395 = Ex1i*Hx1i*Hy2i
    t396 = Ex1r*Hx1i*Hy2r
    t397 = Ex1r*Hx1r*Hy2i
    t398 = Ex1i*Hx1i*Hy2r
    t399 = Ex1i*Hx1r*Hy2i
    t400 = Ex1r*Hx1r*Hy2r
    t401 = Ex2i*t3
    t402 = Ex2i*t7
    t403 = Ex1r*Hx1i*Hx2r
    t404 = t401+t402+t403-Ex1i*Hx1i*Hx2i-Ex1i*Hx1r*Hx2r-Ex1r*Hx2i*Hx1r
    t405 = t21*t404
    t406 = Ex2r*t3
    t407 = Ex2r*t7
    t408 = Ex1i*Hx2i*Hx1r
    t409 = t406+t407+t408-Ex1i*Hx1i*Hx2r-Ex1r*Hx1i*Hx2i-Ex1r*Hx1r*Hx2r
    t410 = t21*t409
    t417 = Ey1i*Hy1i*t5
    t418 = Ey2i*Hy2i*t3
    t419 = Ey1i*Hy1i*t8
    t420 = Ey2i*Hy2i*t7
    t421 = Ey1r*Hy1r*t5
    t422 = Ey2r*Hy2r*t3
    t423 = Ey1r*Hy1r*t8
    t424 = Ey2r*Hy2r*t7
    t425 = Ey1i*Hx2i*Hx1r*Hy2r
    t426 = Ey2i*Hx1i*Hx2r*Hy1r
    t427 = Ey1r*Hx1i*Hx2r*Hy2i
    t428 = Ey2r*Hx2i*Hx1r*Hy1i
    t430 = Ey1i*Hx1i*Hx2i*Hy2i
    t431 = Ey2i*Hx1i*Hx2i*Hy1i
    t432 = Ey1i*Hx1i*Hx2r*Hy2r
    t433 = Ey1i*Hx1r*Hx2r*Hy2i
    t434 = Ey2i*Hx2i*Hx1r*Hy1r
    t435 = Ey2i*Hx1r*Hx2r*Hy1i
    t436 = Ey1r*Hx1i*Hx2i*Hy2r
    t437 = Ey1r*Hx2i*Hx1r*Hy2i
    t438 = Ey2r*Hx1i*Hx2i*Hy1r
    t439 = Ey2r*Hx1i*Hx2r*Hy1i
    t440 = Ey1r*Hx1r*Hx2r*Hy2r
    t441 = Ey2r*Hx1r*Hx2r*Hy1r
    t429 = t417+t418+t419+t420+t421+t422+t423+t424+t425+t426+t427+t428-t430-t431-t432-t433-t434-t435-t436-t437-t438-t439-t440-t441
    t448 = Ey2i*Hx1r*Hy1i
    t449 = Ey2r*Hx1i*Hy1r
    t450 = Ey2i*Hx2i*Hy1i
    t451 = Ey1r*Hx2i*Hy2r
    t452 = Ey2r*Hx2i*Hy1r
    t453 = Ey2r*Hx2r*Hy1i
    t454 = Ey1i*Hx2r*Hy2i
    t455 = Ey2i*Hx2i*Hy1r
    t456 = Ey2i*Hx2r*Hy1i
    t457 = Ey2r*Hx2r*Hy1r
    t458 = Ey1i*Hy1r*t5
    t459 = Ey2i*Hy2r*t3
    t460 = Ey1i*Hy1r*t8
    t461 = Ey2i*Hy2r*t7
    t462 = Ey1i*Hx1i*Hx2r*Hy2i
    t463 = Ey2i*Hx2i*Hx1r*Hy1i
    t464 = Ey1r*Hx1i*Hx2i*Hy2i
    t465 = Ey2r*Hx1i*Hx2i*Hy1i
    t466 = Ey1r*Hx1i*Hx2r*Hy2r
    t467 = Ey1r*Hx1r*Hx2r*Hy2i
    t468 = Ey2r*Hx2i*Hx1r*Hy1r
    t469 = Ey2r*Hx1r*Hx2r*Hy1i
    t476 = Ey1r*Hy1i*t5
    t477 = Ey2r*Hy2i*t3
    t478 = Ey1r*Hy1i*t8
    t479 = Ey2r*Hy2i*t7
    t480 = Ey1i*Hx1i*Hx2i*Hy2r
    t481 = Ey1i*Hx2i*Hx1r*Hy2i
    t482 = Ey2i*Hx1i*Hx2i*Hy1r
    t483 = Ey2i*Hx1i*Hx2r*Hy1i
    t484 = Ey1i*Hx1r*Hx2r*Hy2r
    t485 = Ey2i*Hx1r*Hx2r*Hy1r
    t486 = Ey1r*Hx2i*Hx1r*Hy2r
    t487 = Ey2r*Hx1i*Hx2r*Hy1r
    t470 = t458+t459+t460+t461+t462+t463+t464+t465+t466+t467+t468+t469-t476-t477-t478-t479-t480-t481-t482-t483-t484-t485-t486-t487
    t471 = Ey1i*t5
    t472 = Ey1i*t8
    t473 = Ey2r*Hx2i*Hx1r
    t474 = t471+t472+t473-Ey2i*Hx1i*Hx2i-Ey2i*Hx1r*Hx2r-Ey2r*Hx1i*Hx2r
    t475 = t21*t474
    t488 = Ey1r*t5
    t489 = Ey1r*t8
    t490 = Ey2i*Hx1i*Hx2r
    t491 = t488+t489+t490-Ey2i*Hx2i*Hx1r-Ey2r*Hx1i*Hx2i-Ey2r*Hx1r*Hx2r
    t492 = t21*t491
    t493 = Ey1i*Hx1i*Hy2i
    t494 = Ey1r*Hx1i*Hy2r
    t495 = Ey1r*Hx1r*Hy2i
    t496 = Ey1i*Hx1i*Hy2r
    t497 = Ey1i*Hx1r*Hy2i
    t498 = Ey1r*Hx1r*Hy2r
    t499 = Ey2i*t3
    t500 = Ey2i*t7
    t501 = Ey1r*Hx1i*Hx2r
    t502 = t499+t500+t501-Ey1i*Hx1i*Hx2i-Ey1i*Hx1r*Hx2r-Ey1r*Hx2i*Hx1r
    t503 = t21*t502
    t504 = Ey2r*t3
    t505 = Ey2r*t7
    t506 = Ey1i*Hx2i*Hx1r
    t507 = t504+t505+t506-Ey1i*Hx1i*Hx2r-Ey1r*Hx1i*Hx2i-Ey1r*Hx1r*Hx2r
    t508 = t21*t507


    DD = reshape([ t63, -t58, 0.0, 0.0, t341, -t336, 0.0, 0.0,
                   t58, t63, 0.0, 0.0, t336, t341, 0.0, 0.0,
                   0.0, 0.0, t63, -t58, 0.0, 0.0, t341, -t336,
                   0.0, 0.0, t58, t63, 0.0, 0.0, t336, t341,
                   t77-t28*t41*t72, t68-t28*t72*t94, t245-t28*t72*t199, t240-t28*t72*t258, -t21*(-t117+t120+t121+t346+t347+t348+t349-Ex2i*Hx1r*Hy2i*2.0-Ex2r*Hx2i*Hy1i-Ex2r*Hx1r*Hy2r*2.0)-t28*t72*t317, -t21*(t95+t97-t98-t342+t343-t344-t345-Ex2i*Hx1r*Hy2r*2.0+Ex2i*Hx2r*Hy1r+Ex2r*Hx1r*Hy2i*2.0)-t28*t72*t362, -t21*(-t277+t280+t281+t454+t455+t456+t457-Ey2i*Hx1r*Hy2i*2.0-Ey2r*Hx2i*Hy1i-Ey2r*Hx1r*Hy2r*2.0)-t28*t72*t429, -t21*(t259+t261-t262-t450+t451-t452-t453-Ey2i*Hx1r*Hy2r*2.0+Ey2i*Hx2r*Hy1r+Ey2r*Hx1r*Hy2i*2.0)-t28*t72*t470,
                   t68-t28*t41*t81, -t77-t28*t81*t94, t240-t28*t81*t199, -t245-t28*t81*t258, -t21*(t95+t97-t98+t342+t343+t344+t345-Ex2i*Hx1i*Hy2i*2.0-Ex2i*Hx2r*Hy1r-Ex2r*Hx1i*Hy2r*2.0)-t28*t81*t317, -t21*(t117-t120-t121-t346+t347+t348+t349-Ex2i*Hx1i*Hy2r*2.0+Ex2r*Hx1i*Hy2i*2.0-Ex2r*Hx2i*Hy1i)-t28*t81*t362, -t21*(t259+t261-t262+t450+t451+t452+t453-Ey2i*Hx1i*Hy2i*2.0-Ey2i*Hx2r*Hy1r-Ey2r*Hx1i*Hy2r*2.0)-t28*t81*t429, -t21*(t277-t280-t281-t454+t455+t456+t457-Ey2i*Hx1i*Hy2r*2.0+Ey2r*Hx1i*Hy2i*2.0-Ey2r*Hx2i*Hy1i)-t28*t81*t470,
                   -t21*(t117+t118+t119+t120+t121+t122-Ex1i*Hx2r*Hy2i-Ex2i*Hx2i*Hy1r*2.0-Ex2r*Hx1i*Hy2i-Ex2r*Hx2r*Hy1r*2.0)-t28*t41*t104, -t21*(t95-t96+t97+t98-t99-t100+Ex2i*Hx1r*Hy2r-Ex2i*Hx2r*Hy1r*2.0-Ex1r*Hx2i*Hy2r+Ex2r*Hx2i*Hy1r*2.0)-t28*t94*t104, -t21*(t277+t278+t279+t280+t281+t282-Ey1i*Hx2r*Hy2i-Ey2i*Hx2i*Hy1r*2.0-Ey2r*Hx1i*Hy2i-Ey2r*Hx2r*Hy1r*2.0)-t28*t104*t199, -t21*(t259-t260+t261+t262-t263-t264+Ey2i*Hx1r*Hy2r-Ey2i*Hx2r*Hy1r*2.0-Ey1r*Hx2i*Hy2r+Ey2r*Hx2i*Hy1r*2.0)-t28*t104*t258, t384-t28*t104*t317, t367-t28*t104*t362, t492-t28*t104*t429, t475-t28*t104*t470,
                   -t21*(t95+t96+t97+t98+t99+t100-Ex2i*Hx2i*Hy1i*2.0-Ex2i*Hx1r*Hy2r-Ex1r*Hx2i*Hy2r-Ex2r*Hx2r*Hy1i*2.0)-t28*t41*t126, t21*(t117-t118-t119+t120+t121-t122-Ex1i*Hx2r*Hy2i+Ex2i*Hx2r*Hy1i*2.0+Ex2r*Hx1i*Hy2i-Ex2r*Hx2i*Hy1i*2.0)-t28*t94*t126, -t21*(t259+t260+t261+t262+t263+t264-Ey2i*Hx2i*Hy1i*2.0-Ey2i*Hx1r*Hy2r-Ey1r*Hx2i*Hy2r-Ey2r*Hx2r*Hy1i*2.0)-t28*t126*t199, t21*(t277-t278-t279+t280+t281-t282-Ey1i*Hx2r*Hy2i+Ey2i*Hx2r*Hy1i*2.0+Ey2r*Hx1i*Hy2i-Ey2r*Hx2i*Hy1i*2.0)-t28*t126*t258, t367-t28*t126*t317, -t384-t28*t126*t362, t475-t28*t126*t429, -t492-t28*t126*t470,
                   t136, -t131, 0.0, 0.0, t394, -t389, 0.0, 0.0,
                   t131, t136, 0.0, 0.0, t389, t394, 0.0, 0.0,
                   0.0, 0.0, t136, -t131, 0.0, 0.0, t394, -t389,
                   0.0, 0.0, t131, t136, 0.0, 0.0, t389, t394,
                   t150-t28*t41*t145, t141-t28*t94*t145, t292-t28*t145*t199, t287-t28*t145*t258, -t21*(-t167+t168+t170+t330+t398+t399+t400-Ex1i*Hx2r*Hy1i*2.0-Ex1r*Hx1i*Hy2i-Ex1r*Hx2r*Hy1r*2.0)-t28*t145*t317, -t21*(t156+t157-t160+t331-t395-t396-t397+Ex1i*Hx1r*Hy2r-Ex1i*Hx2r*Hy1r*2.0+Ex1r*Hx2r*Hy1i*2.0)-t28*t145*t362, -t21*(-t301+t302+t304+t448+t496+t497+t498-Ey1i*Hx2r*Hy1i*2.0-Ey1r*Hx1i*Hy2i-Ey1r*Hx2r*Hy1r*2.0)-t28*t145*t429, -t21*(t294+t295-t298+t449-t493-t494-t495+Ey1i*Hx1r*Hy2r-Ey1i*Hx2r*Hy1r*2.0+Ey1r*Hx2r*Hy1i*2.0)-t28*t145*t470,
                   t141-t28*t41*t154, -t150-t28*t94*t154, t287-t28*t154*t199, -t292-t28*t154*t258, -t21*(t156+t157-t160+t331+t395+t396+t397-Ex1i*Hx2i*Hy1i*2.0-Ex1i*Hx1r*Hy2r-Ex1r*Hx2i*Hy1r*2.0)-t28*t154*t317, -t21*(t167-t168-t170-t330+t398+t399+t400-Ex1i*Hx2i*Hy1r*2.0-Ex1r*Hx1i*Hy2i+Ex1r*Hx2i*Hy1i*2.0)-t28*t154*t362, -t21*(t294+t295-t298+t449+t493+t494+t495-Ey1i*Hx2i*Hy1i*2.0-Ey1i*Hx1r*Hy2r-Ey1r*Hx2i*Hy1r*2.0)-t28*t154*t429, -t21*(t301-t302-t304-t448+t496+t497+t498-Ey1i*Hx2i*Hy1r*2.0-Ey1r*Hx1i*Hy2i+Ey1r*Hx2i*Hy1i*2.0)-t28*t154*t470,
                   -t21*(t165+t166+t167+t168+t169+t170-Ex1i*Hx1i*Hy2r*2.0-Ex2i*Hx1r*Hy1i-Ex1r*Hx2i*Hy1i-Ex1r*Hx1r*Hy2r*2.0)-t28*t41*t164, t21*(t155-t156-t157+t158+t159-t160+t331+Ex1i*Hx1r*Hy2r*2.0-Ex1i*Hx2r*Hy1r-Ex1r*Hx1i*Hy2r*2.0)-t28*t94*t164, -t21*(t299+t300+t301+t302+t303+t304-Ey1i*Hx1i*Hy2r*2.0-Ey2i*Hx1r*Hy1i-Ey1r*Hx2i*Hy1i-Ey1r*Hx1r*Hy2r*2.0)-t28*t164*t199, t21*(t293-t294-t295+t296+t297-t298+t449+Ey1i*Hx1r*Hy2r*2.0-Ey1i*Hx2r*Hy1r-Ey1r*Hx1i*Hy2r*2.0)-t28*t164*t258, t410-t28*t164*t317, t405-t28*t164*t362, t508-t28*t164*t429, t503-t28*t164*t470,
                   -t21*(t155+t156+t157+t158+t159+t160-Ex1i*Hx1i*Hy2i*2.0-Ex1i*Hx2r*Hy1r-Ex1r*Hx1r*Hy2i*2.0-Ex2r*Hx1i*Hy1r)-t28*t41*t174, -t21*(t165+t166-t167-t168+t169-t170+t330-Ex1i*Hx1r*Hy2i*2.0+Ex1r*Hx1i*Hy2i*2.0-Ex1r*Hx2i*Hy1i)-t28*t94*t174, -t21*(t293+t294+t295+t296+t297+t298-Ey1i*Hx1i*Hy2i*2.0-Ey1i*Hx2r*Hy1r-Ey1r*Hx1r*Hy2i*2.0-Ey2r*Hx1i*Hy1r)-t28*t174*t199, -t21*(t299+t300-t301-t302+t303-t304+t448-Ey1i*Hx1r*Hy2i*2.0+Ey1r*Hx1i*Hy2i*2.0-Ey1r*Hx2i*Hy1i)-t28*t174*t258, t405-t28*t174*t317, -t410-t28*t174*t362, t503-t28*t174*t429, -t508-t28*t174*t470], 
                 8, 16)

    DD1 = DD[:, 1:8]   # polarization 1
    DD2 = DD[:, 9:16]  # polarization 2

    return DD1, DD2
end # function
